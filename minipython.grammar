Package minipython;

Helpers
	digit = ['0' .. '9'];
	letter = ['a' .. 'z']|['A' .. 'Z']; 
	cr = 13; 
	lf = 10;
	ht = 9;
	ff = 12;
	sp = 32;
	all = [0..127]; 
	eol = lf | cr | cr lf ;
	not_eol = [all - [cr + lf]]; 

Tokens
	tab = 9;
	plusplus = '++';
	equalequal = '==';
	minusminus = '--'; 
	mineq = '-=';
	pluseq = '+=';
	diveq = '/=';
	multeq = '*=';
	plus = '+';
	minus = '-';
	pow = '**';
	mult = '*';
	mod = '%';
	div = '/';
	eq = '=';
	def = 'def';
	not = 'not';
	logic_and = 'and';
	logic_or = 'or';
	l_br = '[';
	r_br = ']';
	l_par = '(';
	r_par = ')';
	comma=',';
	in = 'in';
	if = 'if';
	while = 'while';
	for = 'for';
	len = 'len';
	min = 'min';
	max = 'max';
	print = 'print';
	return = 'return';
	assert = 'assert';
	noteq = '!=';
	lesseq = '<=';
	greateq = '>=';
	less = '<';
	great = '>';
	true = 'true';
	semi = ':';
	false = 'false';
	else = 'else';
	none = 'None';
	quote = '"';
	blank = (' ' | lf | cr);
	white_space = (sp|ff|ht)*;
	line_comment = '#' not_eol* eol; 
	number = digit+;
	dot = '.';
	id = letter (letter | digit)*;
	string_double_quotes = '"'not_eol* '"';
	string_single_quotes = '''not_eol* ''';
	everything_else = all;

Ignored Tokens
	blank, line_comment;

Productions
  goal = commands*;

  commands = {func} function |
  			 {stat} statement;

  function = {definition} def id l_par argument ? r_par semi statement;

  argument = {args} id assign_value ? ciav *;

  ciav = {b} comma id assign_value ?;

  assign_value = {a} eq value;


  statement =
  	{if_statement} if_compount |
    {while_statement} tab* while comparison semi statement |
    {for_statement} tab* [lid]:id in [rid]:id semi statement |
    {return_statement} tab* return expression |
    {print_statement} tab* print expression comma_expression* |
    {id_as_mineq_diveq} tab* id as_mineq_diveq expression |
    {array_statement} tab* id l_br [lex]:expression r_br eq [rex]:expression |
    {assertion_statement} tab* assert expression comma_expression? |
    {func_call} tab* function_call;

  if_compount = tab* if comparison semi statement;
  
  disjunction=
     {agfra} [gg]:conjunction logic_or [t]:conjunction  |
     {bb} conjunction;

	conjunction=
		 {ada}[gg]:inversion logic_and [g]:inversion  | 
		 {dfdfd}inversion;

	inversion=
		{frf} inversion |
		 {fer}comparison;

  as_mineq_diveq = {asmidi} eq | 
  					{mineqq} mineq | 
					{diveq} diveq;

  comma_expression = {c_e} comma expression;

  expression =
    {arithmetic_expression} [lex]:expression operators [rex]:expression |
    {array_expression} id l_br expression r_br |
    {func_call_expression} function_call |
    {value} value |
    {identifier} id |
    {quickpp_mm} expression increment |
    {length_expression} len l_par expression r_par |
    {min_max_expression} operator_max_min l_par value comma_value* r_par |
    {parenthesis_expression} l_par expression r_par |
    {brackets_expression} l_br expression comma_expression* r_br;

  operators = {operc} plus | 
  				{minusc} minus | 
				{miltc} mult | 
				{divc} div | 
				{modc} mod | 
				{powc} pow;

  increment = {addmin} plusplus | minusminus;

  operator_max_min = {maxmin} max | min;

  comma_value = {cv} comma value;

  comparison =
  				{orc}[lcom]:comparison logic_or [rcom]:comparison |  
  				{andc}[lcom]:comparison logic_and [rcom]:comparison |
  				{notc} not disjunction | 
				{eqc}[lpar]:expression equalequal [rpar]:expression|
				{notcc} [lpar]:expression noteq [rpar]:expression|
				{greatc}[lpar]:expression great [rpar]:expression|
				{grcc} [lpar]:expression greateq [rpar]:expression|
				{lessc} [lpar]:expression less [rpar]:expression|
				{lcc}[lpar]:expression lesseq [rpar]:expression|
				{true} true|
				{false} false;



  function_call = {func_call} id l_par arglist? r_par;

  arglist = {arglist} expression comma_expression*;

  value = 
  		{dot_call} id dot function_call |
    	{num} number |
    	{str_d} string_double_quotes |
    	{str_s} string_single_quotes |
    	{none} none;

					
something ={identifier}id|
			{numb}number|
			{par} l_par expression r_par;

